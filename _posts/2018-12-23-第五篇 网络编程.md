---
layout:     post
title:      第五篇 网络编程
subtitle:   知识积累
date:       2018-12-23
author:     guchaolong
header-img: img/post-bg-re-vs-ng2.jpg
catalog: true
tags:
       - Java
---

>Socket   


Socket
+  
    + 是一个抽象概念  
    + 一个应用程序通过一个Socket来建立一个远程连接  
    + Socket内部通过TCP/IP协议把数据传输到网络  
    + Socket、TCP、IP的功能都是操作系统提供的，不同的编程语言只是提供了对操作系统调用的简单封装,例如Java提供的几个类就封装
    了操作体统提供的接口 
+ 为什么需要Socket？
    + 同一台计算机 同一时间会运行多个网络程序，当计算机收到一个数据包的时候，如果只有IP地址，就没法判断应该发给哪个应用程序
    所以操作系统抽象除Socket，每个应用程序需要对应到不同的Socket
    + 可以把IP地址简单理解为IP+端口号（0-65535，由操作系统分配，其中小于1024的端口属于特权端口，需要管理员权限） 
```java
public class TCPClient {
    public static void main(String[] args) {
        InetAddress addr = InetAddress.getLoopbackAddress();//localhost/127.0.0.1
        System.out.println(addr);
        try {
            Socket socket = new Socket(addr, 9090);//打开一个远程连接
            BufferedReader reader = new BufferedReader(new InputStreamReader(socket.getInputStream(), StandardCharsets.UTF_8));
            BufferedWriter writer = new BufferedWriter(new OutputStreamWriter(socket.getOutputStream(), StandardCharsets.UTF_8));
            writer.write("time\n");
            writer.flush();
            String resp = reader.readLine();
            System.out.println("Response: "+resp);
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}

public class TCPServer {
    public static void main(String[] args) {

        try {
            ServerSocket serverSocket = new ServerSocket(9090);
            System.out.println("Tcp server ready");
            Socket socket = serverSocket.accept();

            BufferedReader reader = new BufferedReader(new InputStreamReader(socket.getInputStream(), StandardCharsets.UTF_8));
            BufferedWriter writer = new BufferedWriter(new OutputStreamWriter(socket.getOutputStream(), StandardCharsets.UTF_8));
            String cmd = reader.readLine();
            if("time".equals(cmd)){
                writer.write(LocalDateTime.now().toString()+"\n");
                writer.flush();
            }else{
                writer.write("sorry?\n");
                writer.flush();
            }

            socket.close();
            serverSocket.close();

        } catch (IOException e) {
            e.printStackTrace();
        }

    }
}
```  

      
    

